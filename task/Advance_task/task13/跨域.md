
参考链接：
- [跨域资源共享 CORS 详解(阮一峰)](http://www.ruanyifeng.com/blog/2016/04/cors.html)
- [详解js跨域问题](https://segmentfault.com/a/1190000000718840#articleHeader4)
## 题目1： 什么是同源策略
> 浏览器出于安全方面的考虑，只允许与本域下的接口交互。不同源的客户端脚本在没有明确授权的情况下，不能读写对方的资源

本域指的是？

- 同协议：如都是http或者https
- 同域名：如都是http://jirengu.com/a 和 http://jirengu.com/b
- 同端口：如都是80端口

## 题目2： 什么是跨域？跨域有几种实现形式

只要协议、域名、端口号有一个任何不同，就被当做成不同的域。

```
URL                      说明       是否允许通信
http://www.a.com/a.js
http://www.a.com/b.js     同一域名下   允许
http://www.a.com/lab/a.js
http://www.a.com/script/b.js 同一域名下不同文件夹 允许
http://www.a.com:8000/a.js
http://www.a.com/b.js     同一域名，不同端口  不允许
http://www.a.com/a.js
https://www.a.com/b.js 同一域名，不同协议 不允许
http://www.a.com/a.js
http://70.32.92.74/b.js 域名和域名对应ip 不允许
http://www.a.com/a.js
http://script.a.com/b.js 主域相同，子域不同 不允许
http://www.a.com/a.js
http://a.com/b.js 同一域名，不同二级域名（同上） 不允许（cookie这种情况下也不允许访问）
http://www.cnblogs.com/a.js
http://www.a.com/b.js 不同域名 不允许
```

1. 通过`JSONP`跨域
2. CORS（Cross-Origin Resource Sharing）
3. 通过`document.domain`降域
4. 通过`window.postMessage`

## 题目3： JSONP 的原理是什么

什么是`jsonp`？维基百科的定义是：`JSONP（JSON with Padding）`是资料格式 `JSON` 的一种“使用模式”，可以让网页从别的网域要资料。

`JSONP`也叫填充式JSON，是应用JSON的一种新方法，只不过是被包含在函数调用中的JSON，例如：
```js
callback({"name","trigkit4"});
```
JSONP由两部分组成：回调函数和数据。回调函数是当响应到来时应该在页面中调用的函数，而数据就是传入回调函数中的JSON数据。

在js中，我们直接用`XMLHttpRequest`请求不同域上的数据时，是不可以的。但是，在页面上引入不同域上的js脚本文件却是可以的，jsonp正是利用这个特性来实现的

步骤：
1. 定义数据处理函数_fun
2. 创建script标签，src的地址执行后端接口，最后加个参数callback=_fun
3. 服务端在收到请求后，解析参数，计算返还数据，输出 fun(data) 字符串。
4. fun(data)会放到script标签做为js执行。此时会调用fun函数，将data做为参数。

### JSONP的优缺点

- JSONP的优点是：它不像`XMLHttpRequest`对象实现的Ajax请求那样受到同源策略的限制；它的兼容性更好，在更加古老的浏览器中都可以运行，不需要XMLHttpRequest或ActiveX的支持；并且在请求完毕后可以通过调用callback的方式回传结果。

- JSONP的缺点则是：它只支持GET请求而不支持POST等其它类型的HTTP请求；它只支持跨域HTTP请求这种情况，不能解决不同域的两个页面之间如何进行JavaScript调用的问题

## 题目4： CORS是什么

> CORS（Cross-Origin Resource Sharing）跨域资源共享，定义了必须在访问跨域资源时，浏览器与服务器应该如何沟通。CORS背后的基本思想就是使用自定义的HTTP头部让浏览器与服务器进行沟通，从而决定请求或响应是应该成功还是失败。

浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not-so-simple request）。

只要同时满足以下两大条件，就属于简单请求。

> （1) 请求方法是以下三种方法之一：
- HEAD
- GET
- POST

> （2）HTTP的头信息不超出以下几种字段：
- Accept
- Accept-Language
- Content-Language
- Last-Event-ID
- Content-Type：只限于三个值- application/x-www-form-urlencoded、- multipart/form-data、text/plain

```js
var xhr = new XMLHttpRequest();
xhr.open('get', 'http://b.hth:8080/getNews', true);
xhr.send();
//代码与之前的区别就在于相对路径换成了其他域的绝对路径，也就是你要跨域访问的接口地址。
```

服务器端：
```js
res.header("Access-Control-Allow-Origin", "http://a.hth:8080"); 
//指定可以请求数据的域名为http://a.hth:8080
```

### 非简单请求

非简单请求是那种对服务器有特殊要求的请求，比如请求方法是`PUT`或`DELETE`，或者`Content-Type`字段的类型是`application/json`。

非简单请求的CORS请求，会在正式通信之前，增加一次HTTP查询请求，称为"预检"请求（preflight）。

浏览器先询问服务器，当前网页所在的域名是否在服务器的许可名单之中，以及可以使用哪些HTTP动词和头信息字段。只有得到肯定答复，浏览器才会发出正式的`XMLHttpRequest`请求，否则就报错。

```js
var url = 'http://api.alice.com/cors';
var xhr = new XMLHttpRequest();
xhr.open('PUT', url, true);
xhr.setRequestHeader('X-Custom-Header', 'value');
xhr.send();
```
上面代码中，HTTP请求的方法是`PUT`，并且发送一个自定义头信息`X-Custom-Header`。

下面设置请求回应设置http的头部`Access-Control-Allow-Origin`为`*`,表示同意任意跨源请求。
```js
res.header("Access-Control-Allow-Origin", "*"); 
```

## 题目5： 根据视频里的讲解演示三种以上跨域的解决方式 ，写成博客

[博客传送门](https://github.com/hu970804/Learn-notes/issues/7)